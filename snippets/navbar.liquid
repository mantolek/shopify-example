<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    {% comment %}
            LOGO OR LINK
          {% endcomment %}
    {% if section.settings.logo != blank %}
        <a class="navbar-brand" href="#">
            <img src="{{ section.settings.logo | img_url: 'master' }}" alt="" width="{{ section.settings.logo_max_width }}px"/>
        </a>
    {% else %}
        <a href="{{ routes.root_url }}" itemprop="url" class="navbar-brand">{{ shop.name }}</a>
    {% endif %}

    {% comment %}
            SMALL SCREEN MENU BUTTON
        {% endcomment %}
    <button aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbarText" data-toggle="collapse" type="button">
        <span class="navbar-toggler-icon"></span>
    </button>

    {% comment %}
            IF CUSTOMER ACCOUNT IS REQUIRED
        {% endcomment %}
    {% if shop.customer_accounts_enabled %}

        <div class="collapse navbar-collapse" id="navbarText" style="justify-content: flex-end">
            <ul class="navbar-nav mr-3">
                {% comment %}
                        IF LOGGED IN
                      {% endcomment %}
                {% if customer %}
                    {% for link in linklists[section.settings.menu].links %}
                        {% comment %}
                                DROPDOWN LINK
                              {% endcomment %}
                        {% if link.links != blank %}
                            <li class="nav-item dropdown">
                                <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#!" role="button">
                                    {{ link.title }}
                                </a>
                                <div aria-labelledby="navbarDropdown" class="dropdown-menu">
                                    {% for childlink in link.links %}
                                        <a href="{{ childlink.url }}" class="dropdown-item">
                                            {{ childlink.title }}
                                        </a>
                                    {% endfor %}
                                </div>
                            </li>
                            {% comment %}
                                NORMAL LINK
                            {% endcomment %}
                        {% else %}
                            <li class="nav-item">
                                <a href="{{ link.url }}" class="nav-link">
                                    {{ link.title }}
                                </a>
                            </li>
                        {% endif %}
                    {% endfor %}

                    {% comment %}
                            CART
                        {% endcomment %}
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center" href="{{ routes.cart_url }}">
                            {% if cart.item_count == 0 %}
                                <span class="item-count"></span>
                            {% else %}
                                {%- if cart.item_count > 99 -%}
                                    <span class="item-count">99+</span>
                                {%- else -%}
                                    <span class="item-count">{{ cart.item_count }}</span>
                                {%- endif -%}
                            {% endif %}
                            {% render 'icon-cart' %}
                        </a>
                    </li>

                    {% comment %}
                        IF LOGGED OUT
                      {% endcomment %}
                {% else %}
                    <li class="nav-item">
                        <a href="{{ routes.account_login_url }}" class="nav-link">{{ 'layout.customer.log_in' | t  }}</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ routes.account_register_url }}" class="nav-link">{{ 'layout.customer.create_account' | t }}</a>
                    </li>
                {% endif %}
            </ul>

            {% comment %}
                    IF LOGGED IN
                  {% endcomment %}
            {% if customer %}
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Account</a>
                        <div aria-labelledby="navbarDropdown" class="dropdown-menu">
                            <a href="{{ routes.account_logout_url }}" class="dropdown-item">{{ 'layout.customer.log_out' | t }}</a>
                        </div>
                    </li>
                </ul>
            {% endif %}

        </div>
    {% endif %}
</nav>